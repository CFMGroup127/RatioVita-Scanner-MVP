# RatioVita v0.2.0 Milestone

**Target date**: TBD

## Goals
- End-to-end iOS scan flow wired: capture -> process -> OCR -> save to SwiftData
- macOS build remains green (no UIKit leakage)
- Stable Rich ScanResult pipeline used across services and view models
- Basic unit tests for models and services

## Tasks

### 1. RealScannerService (iOS)
- [ ] Replace placeholder return with AVFoundation capture
- [ ] Add Vision OCR (VNRecognizeTextRequest)
- [ ] Document detection (VNDetectRectanglesRequest)
- [ ] ImageProcessing integration (contrast/sharpen/deskew options)
- [ ] Error handling paths validated (permission denied, invalid image, OCR error)

### 2. ScannerCoordinator + CameraCaptureView
- [ ] Propagate ScanResult back to a ViewModel (closure or environment)
- [ ] Add review/retake screen
- [ ] Add basic auto-capture toggle (configurable via ScannerConfiguration)

### 3. Data layer
- [ ] ReceiptImage: add optional originalSize metadata (non-breaking)
- [ ] Migrations plan (if needed)
- [ ] Add lightweight tests for Receipt/ReceiptImage persistence

### 4. Cross-platform consistency
- [ ] Ensure ImageBridge used everywhere (no duplicate RVImage aliases)
- [ ] Confirm all iOS-only code is under `#if os(iOS)`

### 5. Testing & CI
- [ ] Add more Swift Testing tests (OCRParsing, ImageProcessing stubs)
- [ ] Keep macOS CI green (build + test)
- [ ] Consider code coverage threshold (informational only)

## Deliverables
- Updated RealScannerService with actual capture/OCR path
- Review flow in CameraCaptureView
- Expanded tests
- Updated docs and CHANGELOG entry for 0.2.0

## Risks/Notes
- OCR quality may vary; plan configurable recognition level and language hints
- AVFoundation permissions UX must be polished
- Keep macOS target uncompromised by iOS camera code
